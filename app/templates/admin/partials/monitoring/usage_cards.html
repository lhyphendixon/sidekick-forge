<!-- Usage Overview Cards -->
<div class="grid grid-cols-1 md:grid-cols-3 gap-4">
    <!-- Voice Usage Card -->
    <div class="bg-dark-surface rounded-lg border border-dark-border p-6">
        <div class="flex items-center justify-between">
            <div class="flex-1">
                <div class="flex items-center gap-2 mb-1">
                    <svg class="w-5 h-5 text-brand-teal" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"/>
                    </svg>
                    <h4 class="text-sm font-medium text-dark-text-secondary uppercase tracking-wide">Voice Minutes</h4>
                </div>
                <div class="flex items-baseline gap-2">
                    <span class="text-2xl font-bold text-dark-text">{{ usage_data.voice.minutes_used }}</span>
                    <span class="text-sm text-dark-text-secondary">/ {{ usage_data.voice.minutes_limit }} min</span>
                </div>
                <div class="mt-2">
                    <div class="mini-bar w-full">
                        <div class="mini-bar-fill {% if usage_data.voice.is_exceeded %}exceeded{% elif usage_data.voice.is_warning %}warning{% else %}healthy{% endif %}"
                             style="width: {{ [usage_data.voice.percent, 100]|min }}%"></div>
                    </div>
                    <span class="text-xs {% if usage_data.voice.is_exceeded %}text-brand-salmon{% elif usage_data.voice.is_warning %}text-brand-orange{% else %}text-dark-text-secondary{% endif %} mt-1 block">
                        {{ usage_data.voice.percent }}% used
                    </span>
                </div>
            </div>
            <!-- Circular Progress -->
            <div class="relative w-16 h-16 flex-shrink-0">
                <svg class="quota-ring w-full h-full" viewBox="0 0 36 36">
                    <circle class="quota-ring-bg" cx="18" cy="18" r="15.915" fill="none" stroke-width="3"/>
                    <circle class="quota-ring-progress {% if usage_data.voice.is_exceeded %}exceeded{% elif usage_data.voice.is_warning %}warning{% else %}healthy{% endif %}"
                            cx="18" cy="18" r="15.915" fill="none" stroke-width="3"
                            stroke-dasharray="{{ [usage_data.voice.percent, 100]|min }}, 100"
                            stroke-dashoffset="0"/>
                </svg>
                <div class="absolute inset-0 flex items-center justify-center">
                    <span class="text-xs font-semibold text-dark-text">{{ usage_data.voice.percent|int }}%</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Text Messages Card -->
    <div class="bg-dark-surface rounded-lg border border-dark-border p-6">
        <div class="flex items-center justify-between">
            <div class="flex-1">
                <div class="flex items-center gap-2 mb-1">
                    <svg class="w-5 h-5 text-brand-orange" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"/>
                    </svg>
                    <h4 class="text-sm font-medium text-dark-text-secondary uppercase tracking-wide">Text Messages</h4>
                </div>
                <div class="flex items-baseline gap-2">
                    <span class="text-2xl font-bold text-dark-text">{{ "{:,}".format(usage_data.text.used) }}</span>
                    <span class="text-sm text-dark-text-secondary">/ {{ "{:,}".format(usage_data.text.limit) }}</span>
                </div>
                <div class="mt-2">
                    <div class="mini-bar w-full">
                        <div class="mini-bar-fill {% if usage_data.text.is_exceeded %}exceeded{% elif usage_data.text.is_warning %}warning{% else %}healthy{% endif %}"
                             style="width: {{ [usage_data.text.percent, 100]|min }}%"></div>
                    </div>
                    <span class="text-xs {% if usage_data.text.is_exceeded %}text-brand-salmon{% elif usage_data.text.is_warning %}text-brand-orange{% else %}text-dark-text-secondary{% endif %} mt-1 block">
                        {{ usage_data.text.percent }}% used
                    </span>
                </div>
            </div>
            <!-- Circular Progress -->
            <div class="relative w-16 h-16 flex-shrink-0">
                <svg class="quota-ring w-full h-full" viewBox="0 0 36 36">
                    <circle class="quota-ring-bg" cx="18" cy="18" r="15.915" fill="none" stroke-width="3"/>
                    <circle class="quota-ring-progress {% if usage_data.text.is_exceeded %}exceeded{% elif usage_data.text.is_warning %}warning{% else %}healthy{% endif %}"
                            cx="18" cy="18" r="15.915" fill="none" stroke-width="3"
                            stroke-dasharray="{{ [usage_data.text.percent, 100]|min }}, 100"
                            stroke-dashoffset="0"/>
                </svg>
                <div class="absolute inset-0 flex items-center justify-center">
                    <span class="text-xs font-semibold text-dark-text">{{ usage_data.text.percent|int }}%</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Embedding Chunks Card -->
    <div class="bg-dark-surface rounded-lg border border-dark-border p-6">
        <div class="flex items-center justify-between">
            <div class="flex-1">
                <div class="flex items-center gap-2 mb-1">
                    <svg class="w-5 h-5 text-brand-salmon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4m0 5c0 2.21-3.582 4-8 4s-8-1.79-8-4"/>
                    </svg>
                    <h4 class="text-sm font-medium text-dark-text-secondary uppercase tracking-wide">Embedding Chunks</h4>
                </div>
                <div class="flex items-baseline gap-2">
                    <span class="text-2xl font-bold text-dark-text">{{ "{:,}".format(usage_data.embedding.used) }}</span>
                    <span class="text-sm text-dark-text-secondary">/ {{ "{:,}".format(usage_data.embedding.limit) }}</span>
                </div>
                <div class="mt-2">
                    <div class="mini-bar w-full">
                        <div class="mini-bar-fill {% if usage_data.embedding.is_exceeded %}exceeded{% elif usage_data.embedding.is_warning %}warning{% else %}healthy{% endif %}"
                             style="width: {{ [usage_data.embedding.percent, 100]|min }}%"></div>
                    </div>
                    <span class="text-xs {% if usage_data.embedding.is_exceeded %}text-brand-salmon{% elif usage_data.embedding.is_warning %}text-brand-orange{% else %}text-dark-text-secondary{% endif %} mt-1 block">
                        {{ usage_data.embedding.percent }}% used
                    </span>
                </div>
            </div>
            <!-- Circular Progress -->
            <div class="relative w-16 h-16 flex-shrink-0">
                <svg class="quota-ring w-full h-full" viewBox="0 0 36 36">
                    <circle class="quota-ring-bg" cx="18" cy="18" r="15.915" fill="none" stroke-width="3"/>
                    <circle class="quota-ring-progress {% if usage_data.embedding.is_exceeded %}exceeded{% elif usage_data.embedding.is_warning %}warning{% else %}healthy{% endif %}"
                            cx="18" cy="18" r="15.915" fill="none" stroke-width="3"
                            stroke-dasharray="{{ [usage_data.embedding.percent, 100]|min }}, 100"
                            stroke-dashoffset="0"/>
                </svg>
                <div class="absolute inset-0 flex items-center justify-center">
                    <span class="text-xs font-semibold text-dark-text">{{ usage_data.embedding.percent|int }}%</span>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Quota Warning Banner -->
{% if usage_data.voice.is_exceeded or usage_data.text.is_exceeded or usage_data.embedding.is_exceeded %}
<div class="mt-4 bg-brand-salmon/10 border border-brand-salmon/30 rounded-lg p-4 flex items-center gap-3">
    <svg class="w-5 h-5 text-brand-salmon flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/>
    </svg>
    <div>
        <p class="text-sm font-medium text-brand-salmon">Quota Exceeded</p>
        <p class="text-xs text-dark-text-secondary">One or more usage quotas have been exceeded. Consider upgrading your plan.</p>
    </div>
    <a href="/admin/user-settings#billing" class="ml-auto bg-brand-salmon hover:bg-brand-salmon/80 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors">
        Upgrade Plan
    </a>
</div>
{% elif usage_data.voice.is_warning or usage_data.text.is_warning or usage_data.embedding.is_warning %}
<div class="mt-4 bg-brand-orange/10 border border-brand-orange/30 rounded-lg p-4 flex items-center gap-3">
    <svg class="w-5 h-5 text-brand-orange flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/>
    </svg>
    <div>
        <p class="text-sm font-medium text-brand-orange">Approaching Quota Limit</p>
        <p class="text-xs text-dark-text-secondary">Usage is above 80% for one or more quotas. Monitor closely or consider upgrading.</p>
    </div>
</div>
{% endif %}
